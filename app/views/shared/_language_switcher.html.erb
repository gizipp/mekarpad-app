<div class="language-switcher" style="position: relative; display: inline-block;">
  <button class="language-button" style="background: transparent; border: 1px solid white; color: white; padding: 0.5rem 1rem; border-radius: 20px; cursor: pointer; display: flex; align-items: center; gap: 0.5rem;">
    <span>üåê</span>
    <span><%= available_locales[I18n.locale] %></span>
    <span style="font-size: 0.8em;">‚ñº</span>
  </button>

  <div class="language-dropdown" style="display: none; position: absolute; top: 100%; right: 0; background: white; border: 1px solid #ddd; border-radius: 8px; margin-top: 0.5rem; min-width: 200px; box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1); z-index: 1000;">
    <% available_locales.each do |locale, name| %>
      <%= link_to name,
                  url_for(locale: locale),
                  class: "language-option",
                  style: "display: block; padding: 0.75rem 1rem; color: #333; text-decoration: none; border-bottom: 1px solid #eee; #{'background: #f5f5f5; font-weight: bold;' if I18n.locale == locale}",
                  data: { turbo: false } %>
    <% end %>
  </div>
</div>

<script>
  document.addEventListener('turbo:load', function() {
    const languageButton = document.querySelector('.language-button');
    const languageDropdown = document.querySelector('.language-dropdown');

    if (languageButton && languageDropdown) {
      languageButton.addEventListener('click', function(e) {
        e.stopPropagation();
        const isVisible = languageDropdown.style.display === 'block';
        languageDropdown.style.display = isVisible ? 'none' : 'block';
      });

      document.addEventListener('click', function() {
        languageDropdown.style.display = 'none';
      });

      languageDropdown.addEventListener('click', function(e) {
        e.stopPropagation();
      });
    }
  });
</script>

<style>
  .language-option:hover {
    background-color: #f0f0f0 !important;
  }

  .language-option:last-child {
    border-bottom: none;
  }
</style>
